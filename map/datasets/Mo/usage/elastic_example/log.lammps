LAMMPS (17 Nov 2016)
# Compute elastic constant tensor for a crystal
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, deformation parameters and initial
#		  configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the minimization of energy w.r.t atom
#  positions in the deformed cell is fully converged.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to check
#  the final max and two-norm forces reported in the log file. If you know
#  that minimization is not required, you can set maxiter = 0.0 in
#  init.mod.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 1.0e-6

# Define the amount of random jiggle for atoms
# This prevents atoms from staying on saddle points
variable atomjiggle equal 1.0e-5

# Uncomment one of these blocks, depending on what units
# you are using in LAMMPS and for output

# metal units, elastic constants in eV/A^3
#units		metal
#variable cfac equal 6.2414e-7
#variable cunits string eV/A^3

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# real units, elastic constants in GPa
#units		real
#variable cfac equal 1.01325e-4
#variable cunits string GPa

# Define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 400
variable maxeval equal 400
variable dmax equal 1.0e-2

# generate the box and atom positions using a diamond lattice
variable a equal 3.169

boundary	p p p

lattice         bcc $a
lattice         bcc 3.169
Lattice spacing in x,y,z = 3.169 3.169 3.169
region		box prism 0 2.0 0 3.0 0 4.0 0.0 0.0 0.0
create_box	1 box
Created triclinic box = (0 0 0) to (6.338 9.507 12.676) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
create_atoms	1 box
Created 48 atoms

# Need to set mass to something, just to satisfy LAMMPS
mass 1 95.94

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.97114 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
       0            0   -520.69055   -21335.594   -21335.594   -21335.594   -21335.594 -2.4161881e-12 -1.7379088e-11 -4.9488189e-13        6.338        9.507       12.676    763.79702 
       1            0   -520.69355   -20613.123   -20613.123   -20613.123   -20613.123 -1.4297642e-11 -4.222318e-13 -1.8403483e-11    6.3373662    9.5060493    12.674732     763.5679 
       2            0   -520.69644    -19888.71    -19888.71    -19888.71    -19888.71 2.2676283e-11 4.7420665e-11 5.3450197e-12    6.3367324    9.5050986    12.673465    763.33883 
       3            0   -520.69923    -19162.35    -19162.35    -19162.35    -19162.35 -5.0406863e-12 4.5599272e-12 -4.7609719e-11    6.3360986    9.5041479    12.672197    763.10981 
       4            0   -520.70192   -18434.039   -18434.039   -18434.039   -18434.039 -3.5849162e-12 5.1733547e-12 1.7633124e-12    6.3354648    9.5031972     12.67093    762.88083 
       5            0    -520.7045   -17703.774   -17703.774   -17703.774   -17703.774 1.5480991e-11 5.2871521e-11 -1.5889153e-11     6.334831    9.5022465    12.669662     762.6519 
       6            0   -520.70698    -16971.55    -16971.55    -16971.55    -16971.55 -6.6929456e-12 -2.712174e-12 4.279694e-11    6.3341972    9.5012958    12.668394    762.42301 
       7            0   -520.70935   -16237.363   -16237.363   -16237.363   -16237.363 -1.1289532e-11 2.3191675e-11 -9.7725924e-13    6.3335634    9.5003451    12.667127    762.19417 
       8            0   -520.71162   -15501.211   -15501.211   -15501.211   -15501.211 -1.1409645e-11 -1.508641e-11 -2.1725014e-11    6.3329296    9.4993944    12.665859    761.96537 
       9            0   -520.71378   -14763.088   -14763.088   -14763.088   -14763.088 -1.0435225e-11 2.0359634e-11 1.1077393e-11    6.3322958    9.4984437    12.664592    761.73662 
      10            0   -520.71583   -14022.992   -14022.992   -14022.992   -14022.992 7.065966e-12 1.6759771e-11 -5.1651627e-11     6.331662     9.497493    12.663324    761.50792 
      11            0   -520.71778   -13280.918   -13280.918   -13280.918   -13280.918 4.6000988e-12 2.0956006e-11 4.4978744e-12    6.3310282    9.4965423    12.662056    761.27926 
      12            0   -520.71962   -12536.863   -12536.863   -12536.863   -12536.863 -6.5151123e-12 -1.752945e-12 5.7701106e-12    6.3303944    9.4955916    12.660789    761.05065 
      13            0   -520.72136   -11790.823   -11790.823   -11790.823   -11790.823 1.665798e-12 -1.052083e-12 -1.9361249e-11    6.3297606    9.4946409    12.659521    760.82208 
      14            0   -520.72299   -11042.794   -11042.794   -11042.794   -11042.794 3.6731651e-11 1.1035574e-11 4.3849961e-12    6.3291268    9.4936902    12.658254    760.59356 
      15            0   -520.72451   -10292.773   -10292.773   -10292.773   -10292.773 -4.0354086e-12 -1.8583349e-11 -2.9680723e-12     6.328493    9.4927395    12.656986    760.36509 
      16            0   -520.72592   -9540.7551   -9540.7551   -9540.7551   -9540.7551 -2.4716993e-12 -5.8501758e-13 1.5312835e-11    6.3278592    9.4917888    12.655718    760.13666 
      17            0   -520.72723    -8786.738    -8786.738    -8786.738    -8786.738 3.4131405e-11 -6.9930612e-12 9.1290171e-12    6.3272254    9.4908381    12.654451    759.90827 
      18            0   -520.72843   -8030.7175   -8030.7175   -8030.7175   -8030.7175 1.5322041e-11 5.5317399e-12 -3.5561185e-12    6.3265916    9.4898874    12.653183    759.67994 
      19            0   -520.72952   -7272.6901   -7272.6901   -7272.6901   -7272.6901 -1.872281e-11 2.9130877e-11 2.9130877e-12    6.3259578    9.4889367    12.651916    759.45164 
      20            0    -520.7305   -6512.6522   -6512.6522   -6512.6522   -6512.6522 -6.4282912e-12 2.0412387e-11 -4.6857703e-13     6.325324     9.487986    12.650648     759.2234 
      21            0   -520.73137   -5750.6002   -5750.6002   -5750.6002   -5750.6002 7.9389097e-12 3.3542626e-12 -7.3530123e-12    6.3246902    9.4870353     12.64938     758.9952 
      22            0   -520.73214   -4986.5306   -4986.5306   -4986.5306   -4986.5306 -4.5713739e-12 -3.6629598e-13 -6.2270317e-12    6.3240564    9.4860846    12.648113    758.76704 
      23            0   -520.73279   -4220.4399   -4220.4399   -4220.4399   -4220.4399 -1.0786997e-11 -1.0625778e-11 -2.1456743e-11    6.3234226    9.4851339    12.646845    758.53893 
      24            0   -520.73334   -3452.3246   -3452.3246   -3452.3246   -3452.3246 7.5502365e-12 -1.8428441e-11 -9.4561214e-12    6.3227888    9.4841832    12.645578    758.31087 
      25            0   -520.73378   -2682.1813   -2682.1813   -2682.1813   -2682.1813 -2.1264341e-12 -7.5231773e-12 -6.4672928e-12     6.322155    9.4832325     12.64431    758.08285 
      26            0    -520.7341   -1910.0063   -1910.0063   -1910.0063   -1910.0063 2.7431917e-11 3.8874107e-12 -1.1926283e-11    6.3215212    9.4822818    12.643042    757.85488 
      27            0   -520.73432   -1135.7965   -1135.7965   -1135.7965   -1135.7965 7.571726e-12 -5.6641206e-12 3.389668e-11    6.3208874    9.4813311    12.641775    757.62695 
      28            0   -520.73443   -359.54822   -359.54822   -359.54822   -359.54822 5.5630767e-12 -5.9740691e-12 2.1430322e-12    6.3202536    9.4803804    12.640507    757.39907 
      29            0   -520.73444  -0.21515251  -0.21515251  -0.21515251  -0.21515251 -3.3030772e-11 6.1804244e-12 -1.2771898e-11    6.3199608    9.4799412    12.639922     757.2938 
      30            0   -520.73444 -0.00023907477 -0.00023907493 -0.00023907435 -0.00023907503 -1.9011046e-11 2.6571423e-11 9.8211503e-12    6.3199606    9.4799409    12.639921    757.29374 
      31            0   -520.73444 4.6341932e-10 2.4036128e-10 7.5395312e-10 3.9594356e-10 -2.9507492e-11 1.4680344e-11 9.2339365e-12    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.563588 on 1 procs for 31 steps with 48 atoms

94.1% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.690548737     -520.734436844     -520.734436844
  Force two-norm initial, final = 17.617 5.2848e-13
  Force max component initial, final = 10.1712 3.57385e-13
  Final line search alpha, max atom move = 1 3.57385e-13
  Iterations, force evaluations = 31 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.56091    | 0.56091    | 0.56091    |   0.0 | 99.52
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0002284  | 0.0002284  | 0.0002284  |   0.0 |  0.04
Output  | 0.0011516  | 0.0011516  | 0.0011516  |   0.0 |  0.20
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001298   |            |       |  0.23

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 2.40361275638409e-10
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 7.53953117586113e-10
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal 3.95943563503545e-10
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal 9.23393650379035e-12
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal 1.46803442031643e-11
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal -2.95074918483603e-11

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 6.31996059530001
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 9.47994089295002
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 12.6399211906

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-2.40361275638409e-10)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-2.40361275638409e-10)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-7.53953117586113e-10)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-7.53953117586113e-10)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-3.95943563503545e-10)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-3.95943563503545e-10)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-9.23393650379035e-12)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-9.23393650379035e-12)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-1.46803442031643e-11)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-1.46803442031643e-11)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--2.95074918483603e-11)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--2.95074918483603e-11)/(v_delta/v_len0)*0.0001

displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 1e-05 87287 units box

# Write restart
unfix 3
write_restart restart.equil

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 6.31996059530001
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*6.31996059530001
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -6.31996059530001e-06 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -6.31996059530001e-06 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -6.31996059530001e-06 xy delta -0 xz delta -0 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32897 9.49347 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32897 9.49347 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32897 9.49347 12.658) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444    2.5869005    4.7277194    1.5164945    1.5164876 -5.6946116e-06 6.8068763e-06 -1.9665132e-05    6.3199543    9.4799409    12.639921    757.29298 
      32            0   -520.73444    2.5867034    4.7275247    1.5162923    1.5162933 8.3682638e-07 8.2406057e-07 -1.9881161e-06    6.3199543    9.4799409    12.639921    757.29298 
      33            0   -520.73444     2.586679    4.7275013    1.5162677    1.5162681 2.0248866e-07 -1.0798508e-07 -1.4532652e-07    6.3199543    9.4799409    12.639921    757.29298 
      34            0   -520.73444    2.5866764    4.7274988    1.5162651    1.5162653 -8.7715732e-09 -4.0727074e-08 -2.2640505e-08    6.3199543    9.4799409    12.639921    757.29298 
      35            0   -520.73444    2.5866758    4.7274981    1.5162646    1.5162646 1.3152779e-08 -1.0717954e-08 -1.1292396e-08    6.3199543    9.4799409    12.639921    757.29298 
      36            0   -520.73444    2.5866755    4.7274978    1.5162644    1.5162644 1.6807249e-09 1.4278704e-09 -5.4408787e-09    6.3199543    9.4799409    12.639921    757.29298 
      37            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 8.9256582e-10 -4.4311195e-10 -1.3612363e-09    6.3199543    9.4799409    12.639921    757.29298 
      38            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 1.9401562e-10 -5.7676194e-10 5.2849292e-12    6.3199543    9.4799409    12.639921    757.29298 
      39            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 -7.2109923e-11 -1.0757767e-10 -7.075933e-11    6.3199543    9.4799409    12.639921    757.29298 
      40            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 3.0182818e-11 -1.7381545e-11 -4.3952994e-11    6.3199543    9.4799409    12.639921    757.29298 
      41            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 3.5350304e-11 4.2631762e-11 -5.3539269e-11    6.3199543    9.4799409    12.639921    757.29298 
      42            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 -1.4210587e-11 1.7146659e-11 -5.1997831e-11    6.3199543    9.4799409    12.639921    757.29298 
      43            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 1.0334973e-11 -2.9125832e-11 -8.2503617e-12    6.3199543    9.4799409    12.639921    757.29298 
      44            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 -2.3606017e-11 -7.8686724e-12 6.1716229e-11    6.3199543    9.4799409    12.639921    757.29298 
      45            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 -2.5719989e-11 -2.0200174e-11 -1.8306408e-11    6.3199543    9.4799409    12.639921    757.29298 
      46            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 -7.3989009e-11 3.476309e-11 -4.3600666e-12    6.3199543    9.4799409    12.639921    757.29298 
      47            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 2.5837432e-12 3.7346833e-11 -2.7173344e-11    6.3199543    9.4799409    12.639921    757.29298 
      48            0   -520.73444    2.5866754    4.7274977    1.5162643    1.5162643 3.7816604e-11 3.4058433e-12 -1.3168282e-11    6.3199543    9.4799409    12.639921    757.29298 
Loop time of 0.587414 on 1 procs for 17 steps with 48 atoms

93.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.00098965 3.13161e-11
  Force max component initial, final = 0.000176815 8.60185e-12
  Final line search alpha, max atom move = 1 8.60185e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.58624    | 0.58624    | 0.58624    |   0.0 | 99.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00019193 | 0.00019193 | 0.00019193 |   0.0 |  0.03
Output  | 0.00066185 | 0.00066185 | 0.00066185 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003183  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4.72749768109662
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1.5162642544414
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1.51626425400947
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 3.78166044839557e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 3.40584326097738e-12
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.31682819185203e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 472.749768085626
variable C2neg equal ${d2}
variable C2neg equal 151.626425368745
variable C3neg equal ${d3}
variable C3neg equal 151.626425361353
variable C4neg equal ${d4}
variable C4neg equal -2.24022184223106e-09
variable C5neg equal ${d5}
variable C5neg equal -1.12745009421869e-09
variable C6neg equal ${d6}
variable C6neg equal 6.7324096332316e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*6.31996059530001
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 6.31996059530001e-06 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 6.31996059530001e-06 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 6.31996059530001e-06 xy delta 0 xz delta 0 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32899 9.49347 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32899 9.49347 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32899 9.49347 12.658) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444   -2.5864186   -4.7272161   -1.5160163   -1.5160233 -5.6945035e-06 6.806784e-06 -1.9664841e-05    6.3199669    9.4799409    12.639921     757.2945 
      32            0   -520.73444   -2.5866156   -4.7274108   -1.5162186   -1.5162176 8.3680979e-07 8.2399163e-07 -1.9881434e-06    6.3199669    9.4799409    12.639921     757.2945 
      33            0   -520.73444   -2.5866401   -4.7274342   -1.5162432   -1.5162428 2.0247064e-07 -1.0800271e-07 -1.4534298e-07    6.3199669    9.4799409    12.639921     757.2945 
      34            0   -520.73444   -2.5866427   -4.7274367   -1.5162457   -1.5162456 -8.6801852e-09 -4.0750951e-08 -2.2694835e-08    6.3199669    9.4799409    12.639921     757.2945 
      35            0   -520.73444   -2.5866433   -4.7274374   -1.5162463   -1.5162463 1.3150639e-08 -1.0678941e-08 -1.1320971e-08    6.3199669    9.4799409    12.639921     757.2945 
      36            0   -520.73444   -2.5866436   -4.7274377   -1.5162465   -1.5162465 1.6430225e-09 1.4151838e-09 -5.4573244e-09    6.3199669    9.4799409    12.639921     757.2945 
      37            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 8.9456056e-10 -3.4739532e-10 -1.3928256e-09    6.3199669    9.4799409    12.639921     757.2945 
      38            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 1.3564624e-10 -5.7464682e-10 -8.3824682e-11    6.3199669    9.4799409    12.639921     757.2945 
      39            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -3.6642102e-11 -5.4023613e-11 -3.5922766e-11    6.3199669    9.4799409    12.639921     757.2945 
      40            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 1.4093116e-11 -3.0535085e-11 -3.430793e-11    6.3199669    9.4799409    12.639921     757.2945 
      41            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -4.2514234e-11 -5.0265448e-11 5.1527957e-12    6.3199669    9.4799409    12.639921     757.2945 
      42            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -6.459345e-11 -1.2214034e-11 1.6897059e-11    6.3199669    9.4799409    12.639921     757.2945 
      43            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -9.5128535e-12 -2.1257117e-11 -1.068728e-11    6.3199669    9.4799409    12.639921     757.2945 
      44            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -1.1861706e-11 3.6876988e-11 -2.764306e-11    6.3199669    9.4799409    12.639921     757.2945 
      45            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -5.0500334e-12 1.0804723e-11 -1.3271018e-11    6.3199669    9.4799409    12.639921     757.2945 
      46            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -1.6441969e-11 -1.2566362e-11 2.6512675e-11    6.3199669    9.4799409    12.639921     757.2945 
      47            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -3.875607e-11 -5.0382891e-11 -5.5051236e-12    6.3199669    9.4799409    12.639921     757.2945 
      48            0   -520.73444   -2.5866437   -4.7274378   -1.5162466   -1.5162466 -7.751214e-12 2.0552461e-11 -5.7253285e-13    6.3199669    9.4799409    12.639921     757.2945 
Loop time of 0.583498 on 1 procs for 17 steps with 48 atoms

94.1% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.000989643 3.13101e-11
  Force max component initial, final = 0.000176815 8.603e-12
  Final line search alpha, max atom move = 1 8.603e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.5824     | 0.5824     | 0.5824     |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00025177 | 0.00025177 | 0.00025177 |   0.0 |  0.04
Output  | 0.0005424  | 0.0005424  | 0.0005424  |   0.0 |  0.09
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003073  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843122
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.58664368696205
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -4.72743780752498
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -1.51624662650195
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -1.51624662685922
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -7.75121398805677e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2.05524613319687e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -5.72532851390557e-13

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 472.743780776534
variable C2pos equal ${d2}
variable C2pos equal 151.62466272559
variable C3pos equal ${d3}
variable C3pos equal 151.624662725516
variable C4pos equal ${d4}
variable C4pos equal 9.80646935518091e-10
variable C5pos equal ${d5}
variable C5pos equal -5.8721171288044e-10
variable C6pos equal ${d6}
variable C6pos equal -2.17562778603035e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(472.749768085626+${C1pos})
variable C11 equal 0.5*(472.749768085626+472.743780776534)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(151.626425368745+${C2pos})
variable C21 equal 0.5*(151.626425368745+151.62466272559)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(151.626425361353+${C3pos})
variable C31 equal 0.5*(151.626425361353+151.624662725516)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-2.24022184223106e-09+${C4pos})
variable C41 equal 0.5*(-2.24022184223106e-09+9.80646935518091e-10)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-1.12745009421869e-09+${C5pos})
variable C51 equal 0.5*(-1.12745009421869e-09+-5.8721171288044e-10)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(6.7324096332316e-09+${C6pos})
variable C61 equal 0.5*(6.7324096332316e-09+-2.17562778603035e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 9.47994089295002
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.47994089295002
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -9.47994089295002e-06 yz delta ${deltayz} remap units box
change_box all y delta 0 -9.47994089295002e-06 yz delta -0 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49346 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49346 12.658) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444    2.5869005     1.516486     4.727728    1.5164876 -5.6945823e-06 6.8067277e-06 -1.9665063e-05    6.3199606    9.4799314    12.639921    757.29298 
      32            0   -520.73444    2.5867034    1.5162913    4.7275257    1.5162933 8.3683143e-07 8.2398564e-07 -1.9881551e-06    6.3199606    9.4799314    12.639921    757.29298 
      33            0   -520.73444     2.586679    1.5162678    4.7275011    1.5162681 2.0244203e-07 -1.0802008e-07 -1.4537948e-07    6.3199606    9.4799314    12.639921    757.29298 
      34            0   -520.73444    2.5866764    1.5162653    4.7274986    1.5162653 -8.7628824e-09 -4.0764186e-08 -2.2668471e-08    6.3199606    9.4799314    12.639921    757.29298 
      35            0   -520.73444    2.5866758    1.5162647     4.727498    1.5162646 1.3107329e-08 -1.0770686e-08 -1.1273385e-08    6.3199606    9.4799314    12.639921    757.29298 
      36            0   -520.73444    2.5866755    1.5162644    4.7274978    1.5162644 1.7098508e-09 1.3639815e-09 -5.4261249e-09    6.3199606    9.4799314    12.639921    757.29298 
      37            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 8.9080418e-10 -3.8368586e-10 -1.3930633e-09    6.3199606    9.4799314    12.639921    757.29298 
      38            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 1.4140122e-10 -5.5585711e-10 -7.7204007e-11    6.3199606    9.4799314    12.639921    757.29298 
      39            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 -4.6977148e-11 -1.5737345e-11 -7.811419e-11    6.3199606    9.4799314    12.639921    757.29298 
      40            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 5.9895864e-12 1.2566387e-11 -2.7863321e-11    6.3199606    9.4799314    12.639921    757.29298 
      41            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 -6.4593579e-12 3.9930576e-12 1.2125976e-11    6.3199606    9.4799314    12.639921    757.29298 
      42            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 4.2631762e-11 -2.2196703e-11 -2.210862e-11    6.3199606    9.4799314    12.639921    757.29298 
      43            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 -1.6207116e-11 -1.3388487e-11 -2.3591337e-11    6.3199606    9.4799314    12.639921    757.29298 
      44            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 2.5015332e-11 5.5433035e-11 3.8007449e-11    6.3199606    9.4799314    12.639921    757.29298 
      45            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 3.1592132e-11 5.2262078e-11 -8.3678046e-12    6.3199606    9.4799314    12.639921    757.29298 
      46            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 -1.350593e-11 1.7851316e-11 4.6389934e-12    6.3199606    9.4799314    12.639921    757.29298 
      47            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 7.2462251e-11 1.103963e-11 -4.1824342e-11    6.3199606    9.4799314    12.639921    757.29298 
      48            0   -520.73444    2.5866754    1.5162643    4.7274977    1.5162643 6.341915e-12 -1.0569858e-12 -1.6207116e-11    6.3199606    9.4799314    12.639921    757.29298 
Loop time of 0.595263 on 1 procs for 17 steps with 48 atoms

94.4% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.00098965 3.13244e-11
  Force max component initial, final = 0.000176816 8.61671e-12
  Final line search alpha, max atom move = 1 8.61671e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.59406    | 0.59406    | 0.59406    |   0.0 | 99.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00024319 | 0.00024319 | 0.00024319 |   0.0 |  0.04
Output  | 0.00065207 | 0.00065207 | 0.00065207 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003045  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1.51626425351124
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4.72749768227407
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1.51626425396211
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 6.34191503768202e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.05698583961367e-12
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.62071162074096e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 151.626425327088
variable C2neg equal ${d2}
variable C2neg equal 472.749768152012
variable C3neg equal ${d3}
variable C3neg equal 151.626425356617
variable C4neg equal ${d4}
variable C4neg equal -2.54410527112e-09
variable C5neg equal ${d5}
variable C5neg equal -1.5737330042778e-09
variable C6neg equal ${d6}
variable C6neg equal 3.58494068860423e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.47994089295002
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 9.47994089295002e-06 yz delta ${deltayz} remap units box
change_box all y delta 0 9.47994089295002e-06 yz delta 0 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49348 12.658) with tilt (0 0 0)
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49348 12.658) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444   -2.5864186   -1.5160249   -4.7272075   -1.5160233 -5.6944945e-06 6.806839e-06 -1.9664952e-05    6.3199606    9.4799504    12.639921     757.2945 
      32            0   -520.73444   -2.5866156   -1.5162196   -4.7274098   -1.5162176 8.367843e-07 8.2405481e-07 -1.9881307e-06    6.3199606    9.4799504    12.639921     757.2945 
      33            0   -520.73444   -2.5866401    -1.516243   -4.7274344   -1.5162428 2.0243622e-07 -1.0800459e-07 -1.4533056e-07    6.3199606    9.4799504    12.639921     757.2945 
      34            0   -520.73444   -2.5866427   -1.5162455   -4.7274369   -1.5162456 -8.7694416e-09 -4.0789472e-08 -2.2652585e-08    6.3199606    9.4799504    12.639921     757.2945 
      35            0   -520.73444   -2.5866433   -1.5162462   -4.7274375   -1.5162463 1.3111531e-08 -1.0684931e-08 -1.1307039e-08    6.3199606    9.4799504    12.639921     757.2945 
      36            0   -520.73444   -2.5866436   -1.5162465   -4.7274377   -1.5162465 1.7212393e-09 1.3825347e-09 -5.439018e-09    6.3199606    9.4799504    12.639921     757.2945 
      37            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 8.8469538e-10 -4.0306313e-10 -1.4221422e-09    6.3199606    9.4799504    12.639921     757.2945 
      38            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 1.2519385e-10 -5.5726531e-10 -5.1850924e-11    6.3199606    9.4799504    12.639921     757.2945 
      39            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 -3.476302e-11 -4.8738694e-11 -5.8633236e-11    6.3199606    9.4799504    12.639921     757.2945 
      40            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 4.6859612e-11 1.2096592e-11 -1.4357362e-11    6.3199606    9.4799504    12.639921     757.2945 
      41            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466  4.54503e-11 -8.2209845e-13 -2.2240699e-11    6.3199606    9.4799504    12.639921     757.2945 
      42            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 2.8186233e-12 9.1018043e-11 -1.0481755e-11    6.3199606    9.4799504    12.639921     757.2945 
      43            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 -4.9208465e-11 -3.8638627e-11 1.826233e-11    6.3199606    9.4799504    12.639921     757.2945 
      44            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 9.043083e-12 -1.9378035e-11 -4.0811316e-12    6.3199606    9.4799504    12.639921     757.2945 
      45            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 -4.7799153e-11 3.429325e-11 -5.4963154e-11    6.3199606    9.4799504    12.639921     757.2945 
      46            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 2.8773446e-11 2.4780396e-11 7.2374025e-12    6.3199606    9.4799504    12.639921     757.2945 
      47            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 -7.0465582e-12 -4.8621251e-11 4.947271e-12    6.3199606    9.4799504    12.639921     757.2945 
      48            0   -520.73444   -2.5866437   -1.5162466   -4.7274378   -1.5162466 -2.2079216e-11 1.9378035e-11 -4.857721e-11    6.3199606    9.4799504    12.639921     757.2945 
Loop time of 0.567458 on 1 procs for 17 steps with 48 atoms

93.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.000989643 3.13193e-11
  Force max component initial, final = 0.000176814 8.61236e-12
  Final line search alpha, max atom move = 1 8.61236e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.56638    | 0.56638    | 0.56638    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00020146 | 0.00020146 | 0.00020146 |   0.0 |  0.04
Output  | 0.00063562 | 0.00063562 | 0.00063562 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002415  |            |       |  0.04

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843122
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.58664368708235
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1.51624662743343
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -4.72743780677383
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -1.5162466270398
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.20792156023435e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.93780349701419e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -4.85772103910603e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 151.624662767379
variable C2pos equal ${d2}
variable C2pos equal 472.743780752778
variable C3pos equal ${d3}
variable C3pos equal 151.624662743574
variable C4pos equal ${d4}
variable C4pos equal 5.78111468948507e-09
variable C5pos equal ${d5}
variable C5pos equal -4.6976907669776e-10
variable C6pos equal ${d6}
variable C6pos equal -7.4282762460168e-10

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(151.626425327088+${C1pos})
variable C12 equal 0.5*(151.626425327088+151.624662767379)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(472.749768152012+${C2pos})
variable C22 equal 0.5*(472.749768152012+472.743780752778)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(151.626425356617+${C3pos})
variable C32 equal 0.5*(151.626425356617+151.624662743574)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-2.54410527112e-09+${C4pos})
variable C42 equal 0.5*(-2.54410527112e-09+5.78111468948507e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-1.5737330042778e-09+${C5pos})
variable C52 equal 0.5*(-1.5737330042778e-09+-4.6976907669776e-10)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(3.58494068860423e-09+${C6pos})
variable C62 equal 0.5*(3.58494068860423e-09+-7.4282762460168e-10)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 12.6399211906
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*12.6399211906
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.6579) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444    2.5869005     1.516486    1.5164946     4.727721 -5.6945518e-06 6.8068307e-06 -1.9665119e-05    6.3199606    9.4799409    12.639909    757.29298 
      32            0   -520.73444    2.5867034    1.5162913    1.5162923    4.7275267 8.3682826e-07 8.2411835e-07 -1.9881246e-06    6.3199606    9.4799409    12.639909    757.29298 
      33            0   -520.73444     2.586679    1.5162678    1.5162677    4.7275015 2.0242606e-07 -1.0799917e-07 -1.4530202e-07    6.3199606    9.4799409    12.639909    757.29298 
      34            0   -520.73444    2.5866764    1.5162653    1.5162651    4.7274987 -8.7247134e-09 -4.074516e-08 -2.2704452e-08    6.3199606    9.4799409    12.639909    757.29298 
      35            0   -520.73444    2.5866758    1.5162647    1.5162646     4.727498 1.3071861e-08 -1.0667688e-08 -1.1277936e-08    6.3199606    9.4799409    12.639909    757.29298 
      36            0   -520.73444    2.5866755    1.5162644    1.5162644    4.7274978 1.6259965e-09 1.338379e-09 -5.4121492e-09    6.3199606    9.4799409    12.639909    757.29298 
      37            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 8.9902518e-10 -3.2825282e-10 -1.4176235e-09    6.3199606    9.4799409    12.639909    757.29298 
      38            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 1.202615e-10 -5.5456524e-10 9.5569136e-12    6.3199606    9.4799409    12.639909    757.29298 
      39            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 -8.221001e-11 -7.7982066e-11 -1.0076598e-10    6.3199606    9.4799409    12.639909    757.29298 
      40            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 6.2244722e-12 3.2531675e-11 -4.0664594e-11    6.3199606    9.4799409    12.639909    757.29298 
      41            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 6.5768008e-12 -3.3706104e-11 9.2486261e-12    6.3199606    9.4799409    12.639909    757.29298 
      42            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 -2.4780446e-11 2.4663003e-11 1.1714926e-11    6.3199606    9.4799409    12.639909    757.29298 
      43            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 2.372346e-11 -8.5733296e-12 5.8002098e-11    6.3199606    9.4799409    12.639909    757.29298 
      44            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 1.7498988e-11 1.7733874e-11 1.064326e-11    6.3199606    9.4799409    12.639909    757.29298 
      45            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 2.1609488e-11 -2.207926e-11 -3.4205236e-12    6.3199606    9.4799409    12.639909    757.29298 
      46            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 -1.7498988e-11 -3.9225919e-11 -5.2996096e-12    6.3199606    9.4799409    12.639909    757.29298 
      47            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 4.2396876e-11 -4.2279434e-12 -1.9921247e-11    6.3199606    9.4799409    12.639909    757.29298 
      48            0   -520.73444    2.5866754    1.5162643    1.5162643    4.7274977 -2.0200174e-11 -1.5267573e-11 -2.9947932e-12    6.3199606    9.4799409    12.639909    757.29298 
Loop time of 0.583804 on 1 procs for 17 steps with 48 atoms

94.3% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.00098965 3.1304e-11
  Force max component initial, final = 0.000176816 8.60062e-12
  Final line search alpha, max atom move = 1 8.60062e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.58269    | 0.58269    | 0.58269    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00023699 | 0.00023699 | 0.00023699 |   0.0 |  0.04
Output  | 0.0006032  | 0.0006032  | 0.0006032  |   0.0 |  0.10
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002708  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1.51626425343913
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1.51626425444546
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 4.72749768166768
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.02001738237279e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.52675732388641e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2.99479321223873e-12

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 151.626425319877
variable C2neg equal ${d2}
variable C2neg equal 151.626425369151
variable C3neg equal ${d3}
variable C3neg equal 472.749768127174
variable C4neg equal ${d4}
variable C4neg equal -1.22287297160291e-09
variable C5neg equal ${d5}
variable C5neg equal -2.99479174420284e-09
variable C6neg equal ${d6}
variable C6neg equal 9.3073180246324e-10

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*12.6399211906
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444   -2.5864186   -1.5160249   -1.5160163   -4.7272144 -5.6945718e-06 6.8067684e-06 -1.9664899e-05    6.3199606    9.4799409    12.639934     757.2945 
      32            0   -520.73444   -2.5866156   -1.5162196   -1.5162186   -4.7274088 8.3678465e-07 8.2397718e-07 -1.9881129e-06    6.3199606    9.4799409    12.639934     757.2945 
      33            0   -520.73444   -2.5866401    -1.516243   -1.5162432    -4.727434 2.0249142e-07 -1.0798968e-07 -1.4531878e-07    6.3199606    9.4799409    12.639934     757.2945 
      34            0   -520.73444   -2.5866427   -1.5162455   -1.5162457   -4.7274368 -8.7731998e-09 -4.0756705e-08 -2.2661129e-08    6.3199606    9.4799409    12.639934     757.2945 
      35            0   -520.73444   -2.5866433   -1.5162462   -1.5162463   -4.7274375 1.310284e-08 -1.0744709e-08 -1.1254807e-08    6.3199606    9.4799409    12.639934     757.2945 
      36            0   -520.73444   -2.5866436   -1.5162465   -1.5162465   -4.7274377 1.6372678e-09 1.4057884e-09 -5.4836462e-09    6.3199606    9.4799409    12.639934     757.2945 
      37            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 8.4746606e-10 -3.9989218e-10 -1.3314765e-09    6.3199606    9.4799409    12.639934     757.2945 
      38            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 1.8215353e-10 -5.8275036e-10 -7.2418066e-11    6.3199606    9.4799409    12.639934     757.2945 
      39            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 -1.9730363e-11 -5.7546892e-11 -1.379951e-11    6.3199606    9.4799409    12.639934     757.2945 
      40            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 1.6089641e-11 1.7264068e-11 -4.5068612e-12    6.3199606    9.4799409    12.639934     757.2945 
      41            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 1.1861706e-11 -2.2901314e-11 -9.7183781e-12    6.3199606    9.4799409    12.639934     757.2945 
      42            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 4.721194e-11 2.3723413e-11 1.8864223e-11    6.3199606    9.4799409    12.639934     757.2945 
      43            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 1.3388461e-11 -4.2279349e-11 3.5159389e-11    6.3199606    9.4799409    12.639934     757.2945 
      44            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 -2.9478102e-11 1.3858231e-11 5.3436399e-12    6.3199606    9.4799409    12.639934     757.2945 
      45            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 2.759902e-11 2.7481577e-11 -7.8099353e-12    6.3199606    9.4799409    12.639934     757.2945 
      46            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 3.8051414e-11 2.3018757e-11 3.3735397e-11    6.3199606    9.4799409    12.639934     757.2945 
      47            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 -1.6559412e-11 -4.3101447e-11 -7.9126976e-12    6.3199606    9.4799409    12.639934     757.2945 
      48            0   -520.73444   -2.5866437   -1.5162466   -1.5162466   -4.7274378 2.1961773e-11 -5.8721318e-11 3.1151659e-11    6.3199606    9.4799409    12.639934     757.2945 
Loop time of 0.577331 on 1 procs for 17 steps with 48 atoms

94.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436812     -520.734436843     -520.734436843
  Force two-norm initial, final = 0.000989643 3.13099e-11
  Force max component initial, final = 0.000176814 8.60492e-12
  Final line search alpha, max atom move = 1 8.60492e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.57608    | 0.57608    | 0.57608    |   0.0 | 99.78
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00023937 | 0.00023937 | 0.00023937 |   0.0 |  0.04
Output  | 0.00069022 | 0.00069022 | 0.00069022 |   0.0 |  0.12
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00032    |            |       |  0.06

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843122
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.58664368711032
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1.51624662759115
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -1.51624662656532
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -4.72743780717448
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2.19617729661608e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -5.87213180913391e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.11516592474554e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 151.624662783151
variable C2pos equal ${d2}
variable C2pos equal 151.624662731927
variable C3pos equal ${d3}
variable C3pos equal 472.743780757042
variable C4pos equal ${d4}
variable C4pos equal -2.19177227436651e-09
variable C5pos equal ${d5}
variable C5pos equal 7.34016622945034e-09
variable C6pos equal ${d6}
variable C6pos equal -5.14692648145211e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(151.626425319877+${C1pos})
variable C13 equal 0.5*(151.626425319877+151.624662783151)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(151.626425369151+${C2pos})
variable C23 equal 0.5*(151.626425369151+151.624662731927)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(472.749768127174+${C3pos})
variable C33 equal 0.5*(472.749768127174+472.743780757042)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-1.22287297160291e-09+${C4pos})
variable C43 equal 0.5*(-1.22287297160291e-09+-2.19177227436651e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-2.99479174420284e-09+${C5pos})
variable C53 equal 0.5*(-2.99479174420284e-09+7.34016622945034e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(9.3073180246324e-10+${C6pos})
variable C63 equal 0.5*(9.3073180246324e-10+-5.14692648145211e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 12.6399211906
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*12.6399211906
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 -1.26399e-05)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.00022885356 0.00022660867 0.00023317955 0.00022677246 -5.6945917e-06 6.8067998e-06    1.0629818    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1760989e-05 3.1909133e-05 3.0914675e-05 3.2459161e-05 8.3682049e-07 8.2403626e-07    1.0629994    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444 7.3289342e-06 8.4564601e-06 6.3144012e-06 7.2159413e-06 2.0245181e-07 -1.0800869e-07    1.0630013    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7149415e-06 5.9578285e-06 3.7780817e-06 4.4089144e-06 -8.7133128e-09 -4.0772248e-08    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0773102e-06 5.2988255e-06 3.1917802e-06 3.7413249e-06 1.314936e-08 -1.0760692e-08    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.8312197e-06 5.0031201e-06 2.9835473e-06 3.5069918e-06 1.6964606e-09 1.3872338e-09    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7501368e-06 4.9045554e-06 2.9114591e-06 3.4343959e-06 8.8704512e-10 -3.9096693e-10    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7295622e-06 4.8821835e-06 2.8924684e-06 3.4140348e-06 1.6923501e-10 -5.9026728e-10    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.722898e-06 4.8751584e-06 2.8866407e-06 3.4068948e-06 -1.3975688e-11 -7.5985462e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444 3.7215842e-06 4.873887e-06 2.885485e-06 3.4053806e-06 -3.5232826e-13 -5.8721377e-12    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.7214855e-06 4.8738769e-06 2.8853447e-06 3.4052349e-06 1.3388474e-11 -3.6172368e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7213609e-06 4.8737396e-06 2.8850858e-06 3.4052572e-06 -1.7733856e-11 4.1104964e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7214693e-06 4.873836e-06 2.8853054e-06 3.4052665e-06 1.832107e-11 1.0687291e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7213367e-06 4.8736547e-06 2.885151e-06 3.4052045e-06 -3.0535116e-12 1.491523e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.7213423e-06 4.873709e-06 2.885106e-06 3.405212e-06 2.5837406e-12 6.2244659e-12    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7213837e-06 4.8738035e-06 2.8851636e-06 3.4051839e-06 2.3488551e-11 -1.8438512e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.7213742e-06 4.8737651e-06 2.8851638e-06 3.4051937e-06 3.840378e-11 -7.0465652e-13    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7212811e-06 4.8737119e-06 2.8851094e-06 3.4050221e-06 2.8656032e-11 3.4175841e-11    1.0630014    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.605704 on 1 procs for 17 steps with 48 atoms

92.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989646 3.13131e-11
  Force max component initial, final = 0.000176815 8.61004e-12
  Final line search alpha, max atom move = 1 8.61004e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.60443    | 0.60443    | 0.60443    |   0.0 | 99.79
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00021076 | 0.00021076 | 0.00021076 |   0.0 |  0.03
Output  | 0.00076127 | 0.00076127 | 0.00076127 |   0.0 |  0.13
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003011  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4.87371185212229e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 2.88510937285006e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.40502214528166e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2.86560318845767e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 3.41758413049665e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1.06300142462829

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.000487347149084665
variable C2neg equal ${d2}
variable C2neg equal 0.000288435541973247
variable C3neg equal ${d3}
variable C3neg equal 0.000340462620171816
variable C4neg equal ${d4}
variable C4neg equal 106.300142461906
variable C5neg equal ${d5}
variable C5neg equal 1.94954971018022e-09
variable C6neg equal ${d6}
variable C6neg equal 5.8163523732937e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*12.6399211906
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 1.26399e-05)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.00022885377  0.000226609 0.00023317963 0.00022677267 -5.6944999e-06 6.8068017e-06   -1.0630211    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1760918e-05 3.1909056e-05 3.0914573e-05 3.2459125e-05  8.36795e-07 8.2397495e-07   -1.0630034    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444 7.3289632e-06 8.4565533e-06 6.3143988e-06 7.2159376e-06 2.0243067e-07 -1.0797898e-07   -1.0630016    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7149894e-06 5.9578357e-06 3.7781949e-06 4.4089376e-06 -8.7460793e-09 -4.0744884e-08   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0772934e-06 5.2988779e-06 3.1917087e-06 3.7412938e-06 1.3144076e-08 -1.0758696e-08   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.8311045e-06 5.003047e-06 2.9833654e-06 3.5069011e-06 1.6579394e-09 1.4561727e-09   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7500522e-06 4.9045082e-06 2.9113415e-06 3.4343069e-06 8.9972894e-10 -4.6014071e-10   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7296486e-06 4.8822602e-06 2.8925182e-06 3.4141675e-06 1.7757344e-10 -5.8416026e-10   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.722935e-06 4.8752097e-06 2.8866478e-06 3.4069473e-06 -2.4428093e-11 -1.0945665e-10   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444 3.7216363e-06  4.87403e-06 2.8854365e-06 3.4054425e-06 4.3101491e-11 -2.3253665e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.721341e-06 4.8737364e-06 2.8851872e-06 3.4050994e-06 2.3488551e-13 -1.2096604e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7213498e-06 4.8737648e-06 2.885083e-06 3.4052017e-06 -3.1592101e-11 4.1339849e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7214701e-06 4.8737938e-06 2.8852585e-06 3.4053579e-06 9.3954203e-13 9.3954203e-12   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7214756e-06 4.8738453e-06 2.8852938e-06 3.4052878e-06 1.5032672e-11 -4.0047979e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.721419e-06 4.8738322e-06 2.8853024e-06 3.4051222e-06 2.9478131e-11 -2.1609467e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7215068e-06 4.8738251e-06 2.8853198e-06 3.4053756e-06 -1.4680344e-11 4.7564315e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.7213114e-06 4.8736967e-06 2.8851031e-06 3.4051342e-06 -2.4780421e-11 3.9930536e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7213969e-06 4.8737546e-06 2.8852455e-06 3.4051907e-06 -7.164008e-12 1.7733856e-11   -1.0630014    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.566661 on 1 procs for 17 steps with 48 atoms

94.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989647 3.13212e-11
  Force max component initial, final = 0.000176815 8.60366e-12
  Final line search alpha, max atom move = 1 8.60366e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.56556    | 0.56556    | 0.56556    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00023746 | 0.00023746 | 0.00023746 |   0.0 |  0.04
Output  | 0.00060964 | 0.00060964 | 0.00060964 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002573  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843989
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 3.72139693665342e-06
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4.87375460128461e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 2.88524554772288e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.40519066095277e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -7.16400797114418e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.77338557974225e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.06300142462715

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.000487351424000897
variable C2pos equal ${d2}
variable C2pos equal -0.000288449159460529
variable C3pos equal ${d3}
variable C3pos equal -0.000340479471738927
variable C4pos equal ${d4}
variable C4pos equal 106.300142463638
variable C5pos equal ${d5}
variable C5pos equal -3.0535115942582e-10
variable C6pos equal ${d6}
variable C6pos equal -2.23434838772161e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(0.000487347149084665+${C1pos})
variable C14 equal 0.5*(0.000487347149084665+-0.000487351424000897)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(0.000288435541973247+${C2pos})
variable C24 equal 0.5*(0.000288435541973247+-0.000288449159460529)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(0.000340462620171816+${C3pos})
variable C34 equal 0.5*(0.000340462620171816+-0.000340479471738927)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(106.300142461906+${C4pos})
variable C44 equal 0.5*(106.300142461906+106.300142463638)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(1.94954971018022e-09+${C5pos})
variable C54 equal 0.5*(1.94954971018022e-09+-3.0535115942582e-10)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(5.8163523732937e-09+${C6pos})
variable C64 equal 0.5*(5.8163523732937e-09+-2.23434838772161e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 12.6399211906
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*12.6399211906
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 -1.26399e-05 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.00022885356 0.00022461928 0.00023516876 0.00022677265 -5.6946729e-06    1.0630082 -1.9664976e-05    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1760954e-05 2.9919656e-05 3.2904173e-05 3.2459031e-05 8.3682119e-07    1.0630022 -1.988151e-06    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444  7.32897e-06 6.4670836e-06 8.3038629e-06 7.2159634e-06 2.0247507e-07    1.0630013 -1.4534664e-07    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7149517e-06 3.9684265e-06 5.767548e-06 4.4088807e-06 -8.7368013e-09    1.0630014 -2.2593329e-08    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0773597e-06 3.3094054e-06 5.1813037e-06  3.74137e-06 1.3150535e-08    1.0630014 -1.1264331e-08    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.8311168e-06 3.0136346e-06  4.97282e-06 3.5068958e-06 1.627874e-09    1.0630014 -5.4557591e-09    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7500877e-06 2.9150779e-06 4.9008244e-06 3.4343609e-06 9.1041623e-10    1.0630014 -1.3856483e-09    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7297396e-06 2.8929141e-06 4.8820837e-06 3.4142209e-06 1.507965e-10    1.0630014 1.4562901e-11    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.7229445e-06 2.8857339e-06 4.8760238e-06 3.4070757e-06 -4.0987521e-11    1.0630014 -3.3838193e-11    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444  3.72159e-06 2.8844609e-06 4.8749035e-06 3.4054055e-06 4.5685231e-11    1.0630014 -1.6412625e-11    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.7214377e-06 2.8843171e-06 4.8746599e-06 3.405336e-06 1.7264085e-11    1.0630014 -5.7312064e-11    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7214466e-06 2.8844289e-06 4.8745837e-06 3.4053273e-06 6.2244659e-12    1.0630014 1.6530068e-11    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7213829e-06 2.8842012e-06 4.8746506e-06 3.4052967e-06 -1.6676871e-11    1.0630014 7.0025242e-12    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7213682e-06 2.8842392e-06 4.8745541e-06 3.4053112e-06 5.5198094e-12    1.0630014 -4.0356266e-11    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.7214145e-06 2.8842648e-06 4.8746947e-06 3.4052839e-06 -2.9360688e-12    1.0630014 -3.3926275e-11    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7214047e-06 2.8842872e-06 4.8746955e-06 3.4052315e-06 -3.5232826e-12    1.0630014 -2.2916017e-11    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.721314e-06 2.8842791e-06 4.8744627e-06 3.4052002e-06 -3.3118857e-11    1.0630014 6.0189411e-12    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7213681e-06 2.8842711e-06 4.8746802e-06 3.4051531e-06 -2.0200154e-11    1.0630014 2.4442773e-11    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.554816 on 1 procs for 17 steps with 48 atoms

94.7% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989646 3.13155e-11
  Force max component initial, final = 0.000176815 8.60322e-12
  Final line search alpha, max atom move = 1 8.60322e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.55371    | 0.55371    | 0.55371    |   0.0 | 99.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00021386 | 0.00021386 | 0.00021386 |   0.0 |  0.04
Output  | 0.0006454  | 0.0006454  | 0.0006454  |   0.0 |  0.12
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002487  |            |       |  0.04

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2.88427106647468e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4.87468021166696e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.40515306459126e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.02001536235541e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.06300142459431
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2.44427730982686e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.000288403070519904
variable C2neg equal ${d2}
variable C2neg equal 0.000487392625854937
variable C3neg equal ${d3}
variable C3neg equal 0.000340475712102776
variable C4neg equal ${d4}
variable C4neg equal 1.52088365944783e-09
variable C5neg equal ${d5}
variable C5neg equal 106.300142457963
variable C6neg equal ${d6}
variable C6neg equal 9.3073382248062e-10

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*12.6399211906
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 1.26399211906e-05 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 1.26399e-05 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.0002288536 0.00022461931 0.00023516889 0.00022677259 -5.6945019e-06   -1.0629946 -1.9665039e-05    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1761029e-05 2.9919735e-05 3.2904195e-05 3.2459157e-05 8.3675014e-07   -1.0630006 -1.98814e-06    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444 7.328912e-06 6.4669659e-06 8.3037904e-06 7.2159797e-06 2.0240812e-07   -1.0630015 -1.4536481e-07    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7148944e-06 3.9684031e-06 5.767591e-06 4.4086891e-06 -8.731399e-09   -1.0630015 -2.2646956e-08    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0771646e-06 3.3092323e-06 5.1810665e-06 3.741195e-06 1.3115772e-08   -1.0630014 -1.1305362e-08    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.831149e-06 3.0136561e-06 4.9728374e-06 3.5069536e-06 1.6111971e-09   -1.0630014 -5.4679291e-09    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7501348e-06 2.9151286e-06 4.900931e-06 3.4343449e-06 9.4517928e-10   -1.0630014 -1.3667107e-09    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7298513e-06 2.8928669e-06 4.8821496e-06 3.4145375e-06 1.1133573e-10   -1.0630014 -2.3723436e-11    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.7228796e-06 2.8857675e-06 4.8759734e-06 3.4068977e-06 -1.0464149e-10   -1.0630014 -8.7259966e-11    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444 3.7215953e-06 2.8844407e-06 4.8749273e-06 3.405418e-06 3.0535116e-12   -1.0630014 5.6078915e-12    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.7213469e-06 2.8842505e-06 4.8746132e-06 3.4051771e-06 4.4510804e-11   -1.0630014 1.407845e-11    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7214712e-06 2.8844169e-06 4.8747079e-06 3.4052888e-06 -2.2666451e-11   -1.0630014 8.9403296e-12    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7214859e-06 2.8843796e-06 4.8746749e-06 3.405403e-06 -1.9847825e-11   -1.0630014 -7.4032976e-11    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7214336e-06 2.8842741e-06 4.8746552e-06 3.4053713e-06 -2.0552482e-11   -1.0630014 1.8012782e-11    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.721398e-06 2.884301e-06 4.874634e-06 3.405259e-06 4.2866605e-11   -1.0630014 2.5396995e-12    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7214172e-06 2.8841696e-06 4.8748028e-06 3.4052793e-06 4.2279391e-12   -1.0630014 3.7199992e-11    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.7213935e-06 2.8843492e-06 4.8746091e-06 3.4052223e-06 6.3419087e-12   -1.0630014 3.0402993e-11    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7213439e-06 2.8841957e-06 4.8747175e-06 3.4051184e-06 -2.2314123e-11   -1.0630014 -7.2741106e-11    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.597137 on 1 procs for 17 steps with 48 atoms

95.4% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989646 3.13216e-11
  Force max component initial, final = 0.000176815 8.61045e-12
  Final line search alpha, max atom move = 1 8.61045e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.59599    | 0.59599    | 0.59599    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00021935 | 0.00021935 | 0.00021935 |   0.0 |  0.04
Output  | 0.00066018 | 0.00066018 | 0.00066018 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002639  |            |       |  0.04

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843989
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 3.72134385742223e-06
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2.88419566822685e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4.87471754378227e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.40511836025757e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.23141231888098e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.0630014245458
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -7.27411055266792e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.000288395530695121
variable C2pos equal ${d2}
variable C2pos equal -0.000487396359066468
variable C3pos equal ${d3}
variable C3pos equal -0.000340472241669407
variable C4pos equal ${d4}
variable C4pos equal 8.19750420304696e-09
variable C5pos equal ${d5}
variable C5pos equal 106.300142456048
variable C6pos equal ${d6}
variable C6pos equal -7.1933686595505e-10

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(0.000288403070519904+${C1pos})
variable C15 equal 0.5*(0.000288403070519904+-0.000288395530695121)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(0.000487392625854937+${C2pos})
variable C25 equal 0.5*(0.000487392625854937+-0.000487396359066468)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(0.000340475712102776+${C3pos})
variable C35 equal 0.5*(0.000340475712102776+-0.000340472241669407)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(1.52088365944783e-09+${C4pos})
variable C45 equal 0.5*(1.52088365944783e-09+8.19750420304696e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(106.300142457963+${C5pos})
variable C55 equal 0.5*(106.300142457963+106.300142456048)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(9.3073382248062e-10+${C6pos})
variable C65 equal 0.5*(9.3073382248062e-10+-7.1933686595505e-10)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 9.47994089295002

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.47994089295002
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -9.47994089295002e-06 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (-9.47994e-06 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.00022885356 0.00022461922 0.00023369987 0.00022824161    1.0629957 6.8067038e-06 -1.9665084e-05    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1761028e-05 2.9919696e-05 3.1435102e-05 3.3928286e-05    1.0630023 8.2403003e-07 -1.988129e-06    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444 7.3289289e-06 6.4669554e-06 6.8348254e-06 8.6850058e-06    1.0630016 -1.0799519e-07 -1.4537422e-07    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7148208e-06 3.9683318e-06 4.298396e-06 5.8777345e-06    1.0630014 -4.0736546e-08 -2.2669622e-08    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0772913e-06 3.3093558e-06 3.7121339e-06 5.210384e-06    1.0630014 -1.0685411e-08 -1.1283606e-08    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.8310505e-06 3.0135214e-06 3.5037185e-06 4.9759117e-06    1.0630014 1.4043804e-09 -5.4327697e-09    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7500875e-06 2.915021e-06 3.4318063e-06 4.9034353e-06    1.0630014 -3.7323307e-10 -1.4100324e-09    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7295415e-06 2.8926848e-06 3.4128926e-06 4.8830472e-06    1.0630014 -5.2473422e-10 1.2199366e-11    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.7228591e-06 2.8857321e-06 3.4069341e-06 4.8759112e-06    1.0630014 1.0100077e-11 -7.1713481e-11    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444 3.7216622e-06 2.8845003e-06 3.4059092e-06 4.874577e-06    1.0630014 1.0687291e-11 2.0552482e-13    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.7213761e-06 2.8842863e-06 3.4056183e-06 4.8742237e-06    1.0630014 -1.9965268e-11 -1.0511126e-11    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7212446e-06 2.884317e-06 3.4053392e-06 4.8740777e-06    1.0630014 5.1909697e-11 3.2678446e-11    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7213473e-06 2.8842396e-06 3.4055713e-06 4.8742309e-06    1.0630014 4.4745689e-11 -8.4999193e-12    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7213959e-06 2.8842569e-06 3.4056584e-06 4.8742725e-06    1.0630014 -2.219668e-11 2.216732e-11    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.7212495e-06 2.8841462e-06 3.4054762e-06 4.874126e-06    1.0630014 3.4880498e-11 2.8215622e-11    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7214235e-06 2.8843285e-06 3.4056205e-06 4.8743215e-06    1.0630014 -3.8756109e-12 -4.0679234e-11    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.7215044e-06 2.8844186e-06 3.4057778e-06 4.8743168e-06    1.0630014 -2.3488551e-13 -1.9260612e-11    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7214152e-06 2.8843004e-06 3.4055877e-06 4.8743575e-06    1.0630014 5.5198094e-12 2.7525645e-11    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.631921 on 1 procs for 17 steps with 48 atoms

94.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989646 3.13397e-11
  Force max component initial, final = 0.000176815 8.59913e-12
  Final line search alpha, max atom move = 1 8.59913e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.63069    | 0.63069    | 0.63069    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00023365 | 0.00023365 | 0.00023365 |   0.0 |  0.04
Output  | 0.00068355 | 0.00068355 | 0.00068355 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003142  |            |       |  0.05

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2.88430042716308e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 3.4055876761814e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 4.87435750834069e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.063001424568
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 5.51980942038978e-12
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2.75256453809331e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.000288406006588744
variable C2neg equal ${d2}
variable C2neg equal 0.000340483372306381
variable C3neg equal ${d3}
variable C3neg equal 0.000487396156477719
variable C4neg equal ${d4}
variable C4neg equal 1.82917088771428e-09
variable C5neg equal ${d5}
variable C5neg equal -9.16053478277452e-10
variable C6neg equal ${d6}
variable C6neg equal 106.300142459751

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  48 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
include Mo.snap

pair_style snap
pair_coeff * * Mo.snapcoeff Mo Mo.snapparam Mo
SNAP Element = Mo, Radius 0.5, Weight 1 
SNAP keyword rcutfac 4.615858 
SNAP keyword twojmax 6 
# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.47994089295002
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 9.47994089295002e-06 remap units box
  triclinic box = (0.0090197 0.0135296 0.0180394) to (6.32898 9.49347 12.658) with tilt (9.47994e-06 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 400 ${maxeval}
minimize 0 1e-10 400 400
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.61586
  ghost atom cutoff = 5.61586
Memory usage per processor = 3.84651 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
      31            0   -520.73444 0.00022885362 0.00022461936 0.00023369987 0.00022824161   -1.0630071 6.8069039e-06 -1.9664996e-05    6.3199606    9.4799409    12.639921    757.29374 
      32            0   -520.73444 3.1761011e-05 2.9919759e-05 3.143502e-05 3.3928254e-05   -1.0630006 8.2400925e-07 -1.9880827e-06    6.3199606    9.4799409    12.639921    757.29374 
      33            0   -520.73444 7.3288928e-06 6.4668408e-06 6.8347597e-06 8.685078e-06   -1.0630012 -1.0805732e-07 -1.4532303e-07    6.3199606    9.4799409    12.639921    757.29374 
      34            0   -520.73444 4.7149386e-06 3.9685089e-06 4.298498e-06 5.8778091e-06   -1.0630014 -4.0713527e-08 -2.2634654e-08    6.3199606    9.4799409    12.639921    757.29374 
      35            0   -520.73444 4.0773021e-06 3.3093898e-06 3.712052e-06 5.2104644e-06   -1.0630014 -1.0714772e-08 -1.1288157e-08    6.3199606    9.4799409    12.639921    757.29374 
      36            0   -520.73444 3.8312069e-06 3.0137032e-06 3.503947e-06 4.9759706e-06   -1.0630014 1.3644499e-09 -5.4076516e-09    6.3199606    9.4799409    12.639921    757.29374 
      37            0   -520.73444 3.7501354e-06 2.9151499e-06 3.4318197e-06 4.9034366e-06   -1.0630014 -3.9766116e-10 -1.4416098e-09    6.3199606    9.4799409    12.639921    757.29374 
      38            0   -520.73444 3.7296682e-06 2.8928369e-06 3.4129583e-06 4.8832094e-06   -1.0630014 -5.7617415e-10 7.0465652e-12    6.3199606    9.4799409    12.639921    757.29374 
      39            0   -520.73444 3.7229492e-06 2.885671e-06 3.4070078e-06 4.8761687e-06   -1.0630014 -4.1222407e-11 -1.0492042e-10    6.3199606    9.4799409    12.639921    757.29374 
      40            0   -520.73444 3.7216776e-06 2.8845139e-06 3.4059694e-06 4.8745496e-06   -1.0630014 -4.5802674e-12 2.1785631e-11    6.3199606    9.4799409    12.639921    757.29374 
      41            0   -520.73444 3.7212289e-06 2.8841064e-06 3.4053806e-06 4.8741996e-06   -1.0630014 1.7616413e-11 -5.7635031e-11    6.3199606    9.4799409    12.639921    757.29374 
      42            0   -520.73444 3.7212725e-06 2.8842087e-06 3.4054807e-06 4.8741282e-06   -1.0630014 -1.3740802e-11 -1.3696761e-11    6.3199606    9.4799409    12.639921    757.29374 
      43            0   -520.73444 3.7214304e-06 2.8842934e-06 3.4056871e-06 4.8743108e-06   -1.0630014 -1.961294e-11 4.8254291e-11    6.3199606    9.4799409    12.639921    757.29374 
      44            0   -520.73444 3.7214467e-06 2.8843388e-06 3.4055999e-06 4.8744013e-06   -1.0630014 1.5267558e-12 -5.9778362e-11    6.3199606    9.4799409    12.639921    757.29374 
      45            0   -520.73444 3.7213757e-06 2.8842418e-06 3.4056594e-06 4.8742259e-06   -1.0630014 -1.5972214e-11 -1.2581055e-11    6.3199606    9.4799409    12.639921    757.29374 
      46            0   -520.73444 3.7213562e-06 2.8842549e-06 3.4056057e-06 4.8742081e-06   -1.0630014 8.4558783e-12 2.6321857e-11    6.3199606    9.4799409    12.639921    757.29374 
      47            0   -520.73444 3.7214411e-06 2.8843256e-06 3.4057725e-06 4.8742254e-06   -1.0630014 2.5367635e-11 3.6554057e-11    6.3199606    9.4799409    12.639921    757.29374 
      48            0   -520.73444 3.7213372e-06 2.8842322e-06 3.4056237e-06 4.8741557e-06   -1.0630014 -1.9378054e-11 -6.3815456e-11    6.3199606    9.4799409    12.639921    757.29374 
Loop time of 0.602389 on 1 procs for 17 steps with 48 atoms

93.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -520.734436813     -520.734436844     -520.734436844
  Force two-norm initial, final = 0.000989647 3.1347e-11
  Force max component initial, final = 0.000176815 8.61338e-12
  Final line search alpha, max atom move = 1 8.61338e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.60123    | 0.60123    | 0.60123    |   0.0 | 99.81
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00029182 | 0.00029182 | 0.00029182 |   0.0 |  0.05
Output  | 0.00063539 | 0.00063539 | 0.00063539 |   0.0 |  0.11
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002344  |            |       |  0.04

Nlocal:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    498 ave 498 max 498 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  2784 ave 2784 max 2784 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2784
Ave neighs/atom = 58
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -520.734436843989
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 3.72133720722631e-06
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2.88423219292323e-06
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 3.40562368706573e-06
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 4.87415574168996e-06
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.06300142454627
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.93780543481769e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -6.38154562511553e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.000288399183164759
variable C2pos equal ${d2}
variable C2pos equal -0.000340486973394814
variable C3pos equal ${d3}
variable C3pos equal -0.000487375979812646
variable C4pos equal ${d4}
variable C4pos equal 7.30493927549457e-09
variable C5pos equal ${d5}
variable C5pos equal 3.40583985513412e-09
variable C6pos equal ${d6}
variable C6pos equal 106.300142451676

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(0.000288406006588744+${C1pos})
variable C16 equal 0.5*(0.000288406006588744+-0.000288399183164759)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(0.000340483372306381+${C2pos})
variable C26 equal 0.5*(0.000340483372306381+-0.000340486973394814)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(0.000487396156477719+${C3pos})
variable C36 equal 0.5*(0.000487396156477719+-0.000487375979812646)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(1.82917088771428e-09+${C4pos})
variable C46 equal 0.5*(1.82917088771428e-09+7.30493927549457e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-9.16053478277452e-10+${C5pos})
variable C56 equal 0.5*(-9.16053478277452e-10+3.40583985513412e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(106.300142459751+${C6pos})
variable C66 equal 0.5*(106.300142459751+106.300142451676)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 472.74677443108
variable C22all equal ${C22}
variable C22all equal 472.746774452395
variable C33all equal ${C33}
variable C33all equal 472.746774442108

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(151.625544047233+${C21})
variable C12all equal 0.5*(151.625544047233+151.625544047168)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(151.625544051514+${C31})
variable C13all equal 0.5*(151.625544051514+151.625544043435)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(151.625544050539+${C32})
variable C23all equal 0.5*(151.625544050539+151.625544050095)

variable C44all equal ${C44}
variable C44all equal 106.300142462772
variable C55all equal ${C55}
variable C55all equal 106.300142457006
variable C66all equal ${C66}
variable C66all equal 106.300142455713

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-2.13745811602031e-09+${C41})
variable C14all equal 0.5*(-2.13745811602031e-09+-6.29787453356484e-10)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(3.76991239151047e-09+${C51})
variable C15all equal 0.5*(3.76991239151047e-09+-8.57330903549565e-10)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(3.41171199248085e-09+${C61})
variable C16all equal 0.5*(3.41171199248085e-09+2.27839092360062e-09)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-6.80874364099868e-09+${C42})
variable C24all equal 0.5*(-6.80874364099868e-09+1.61850470918254e-09)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-1.86660576548974e-09+${C52})
variable C25all equal 0.5*(-1.86660576548974e-09+-1.02175104048778e-09)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-1.8005442164906e-09+${C62})
variable C26all equal 0.5*(-1.8005442164906e-09+1.42105653200128e-09)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-8.42578355548487e-09+${C43})
variable C34all equal 0.5*(-8.42578355548487e-09+-1.70732262298471e-09)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(1.7352166845053e-09+${C53})
variable C35all equal 0.5*(1.7352166845053e-09+2.17268724262375e-09)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(1.00883325364841e-08+${C63})
variable C36all equal 0.5*(1.00883325364841e-08+-2.10809733949443e-09)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(4.85919393124739e-09+${C54})
variable C45all equal 0.5*(4.85919393124739e-09+8.220992753772e-10)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(4.56705508160442e-09+${C64})
variable C46all equal 0.5*(4.56705508160442e-09+1.79100199278605e-09)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(1.24489318842833e-09+${C65})
variable C56all equal 0.5*(1.24489318842833e-09+1.05698478262785e-10)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (472.74677443108+${C22all}+${C33all})/3.0
variable C11cubic equal (472.74677443108+472.746774452395+${C33all})/3.0
variable C11cubic equal (472.74677443108+472.746774452395+472.746774442108)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (151.6255440472+${C13all}+${C23all})/3.0
variable C12cubic equal (151.6255440472+151.625544047475+${C23all})/3.0
variable C12cubic equal (151.6255440472+151.625544047475+151.625544050317)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (106.300142462772+${C55all}+${C66all})/3.0
variable C44cubic equal (106.300142462772+106.300142457006+${C66all})/3.0
variable C44cubic equal (106.300142462772+106.300142457006+106.300142455713)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (472.746774441861+2*${C12cubic})/3.0
variable bulkmodulus equal (472.746774441861+2*151.625544048331)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 106.300142458497
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (472.746774441861-${C12cubic})/2.0
variable shearmodulus2 equal (472.746774441861-151.625544048331)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+472.746774441861/${C12cubic})
variable poissonratio equal 1.0/(1.0+472.746774441861/151.625544048331)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa
print "${C11all} ${C12all} ${C44all}" file elastic.txt
472.74677443108 151.6255440472 106.300142462772
print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 472.74677443108 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 472.746774452395 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 472.746774442108 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 151.6255440472 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 151.625544047475 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 151.625544050317 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 106.300142462772 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 106.300142457006 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 106.300142455713 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = -1.3836227846884e-09 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = 1.45629074398045e-09 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = 2.84505145804073e-09 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -2.59511946590807e-09 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -1.44417840298876e-09 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -1.8974384224466e-10 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = -5.06655308923479e-09 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = 1.95395196356453e-09 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = 3.99011759849483e-09 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = 2.84064660331229e-09 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = 3.17902853719524e-09 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 6.75295833345557e-10 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 258.665954179508 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 106.300142458497 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 160.560615196765 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.242844757139426
Total wall time: 0:00:07
